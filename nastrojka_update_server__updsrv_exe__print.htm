<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link href="css/printed.css" media="all" rel="StyleSheet" type="text/css" />
		<link href="de_style.css" media="all" rel="StyleSheet" type="text/css" />
		<meta name="generator" content="www.DrExplain.com" />
				<title>&#x041D;&#x0430;&#x0441;&#x0442;&#x0440;&#x043E;&#x0439;&#x043A;&#x0430; Update Server (UpdSrv.exe)</title>
	</head>
	<body>
		<table class="pagetable">
			<tr class="page" style="border-color: #ffffff;">
				<td class="page_area" style="border-color: #ffffff; width: 100%;"><div class="description_on_page"><div class="p" style="text-align: center; direction: ltr; margin-left: 0px; text-indent: 0px;"><div class="ic"><h1><strong>Настройка Update Server (UpdSrv.exe)</strong></h1></div></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C">&#160;&#160; &#160; </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C">&#160;&#160; &#160; Прежде всего надо перейти на последнюю вкладку, а именно Configs. Именно здесь располагаются главные настройки. Детальное описание каждой настройки можно найти в справочнике. Первым делом надо указать такой же порт который был указан при настройке в <strong>LC</strong>. Это можно сделать вписав в поле </span><span class="de_E0F7EC04A3">Port </span><span class="de_23C19DE48C">нужное значение или же оставить стандартное (5500). Теперь осталось только создать обновление и запустить сервер.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_E0F7EC04A3">Типы обновления.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C">&#160;&#160; &#160; </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C">&#160;&#160; &#160; Всего существует 3 типа обновления. Используя FTP, HTTP или же Direct Download (оно же Socket). Остановимся на каждом из них.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">&#160;1) &#160; &#160; </span><span class="de_23C19DE48C"> Обновление через HTTP сервер. Обновление клиента будет происходить скачиванием файлов которые должны быть размещены на НТТР сервере. НТТР сервер может стоять на другом, удаленном, ПК. Главное чтобы файлы, которые Вы планируете обновлять, были и на удаленном ПК. Данный тип обновления несколько не стабилен, медленный и ресурсоемкий. </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">&#160;2) &#160; &#160; </span><span class="de_23C19DE48C"> Обновление через FTP сервер. Принцип аналогичен предыдущему пункту но с той разницей что вместо НТТР сервера используется FTP. Как правило скачивание файлов с FTP сервера несколько стабильней и быстрее. О этом говорит само слово FTP (англ.File Transfer Protocol — протокол передачи файлов).</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">&#160;3) &#160; &#160; </span><span class="de_23C19DE48C"> Прямое обновление. <strong>Launcher </strong>закачивает файлы напрямую через <strong>UpdSrv</strong>. Игровой клиент должен располагаться на том же ПК на котором установлен и <strong>UpdSrv</strong>. Данный тип обновления работает гораздо быстрее и более стабильный. </span><span class="de_E0F7EC04A3">Использование архивации предусмотрено только с этим типом обновления. </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_E0F7EC04A3">Создание пакета обновления.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C">&#160;&#160; &#160; Что такое пакеты обновлений? Предполагаю что каждому Администратору хотя бы раз в жизни надо было разделить обновление. Например чтобы человек который запускает <strong>Launcher </strong>имел выбор качать ему клиент со звуком или без, закачать полную версию или облегченную, закачать оригинальную версию или с некоторыми дополнениями. Как правило тут и возникали проблемы. А как же создать такую возможность? Для этого и была разработана система пакетов. При первом запуске у клиента спрашивается какой же пакет обновления ему более близок. В последствии все новые обновления будут загружаться используя именно этот пакет. Если пользователь захочет изменить пакет то ему достаточно будет внести изменения в настройках. </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C">&#160;&#160; &#160; Чтобы создать пакет обновлений нужно перейти на вкладку </span><span class="de_E0F7EC04A3">General Update</span><span class="de_23C19DE48C">. С правой стороны отображается панель </span><span class="de_E0F7EC04A3">Package Control</span><span class="de_23C19DE48C">. Прежде всего надо придумать и вписать имя пакета в поле </span><span class="de_E0F7EC04A3">Package Name</span><span class="de_23C19DE48C"> и нажать </span><span class="de_E0F7EC04A3">Add</span><span class="de_23C19DE48C">. Стоит принять к сведению что именно это имя будет отображено в <strong>Launcher’е </strong>. Созданный пакет автоматически помещается в список </span><span class="de_E0F7EC04A3">Package List</span><span class="de_23C19DE48C">. Сразу стоит выбрать этот пакет из списка. Дальше в поле </span><span class="de_E0F7EC04A3">Client Directory </span><span class="de_23C19DE48C">необходимо</span><span class="de_E0F7EC04A3"> </span><span class="de_23C19DE48C">выбрать каталог в котором установлен игровой клиент. Теперь в зависимости от выбранного типа обновления рассмотрим различные ситуации:</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">&#160;1) &#160; &#160; </span><span class="de_23C19DE48C">Socket без архивации. Нажать на кнопку </span><span class="de_E0F7EC04A3">Refresh </span><span class="de_23C19DE48C">на вкладке </span><span class="de_E0F7EC04A3">Full Update</span><span class="de_23C19DE48C">. Больше ничего. Всё остальное за вас сделает <strong>UpdSrv</strong>, а поле </span><span class="de_E0F7EC04A3">Host </span><span class="de_23C19DE48C">и список </span><span class="de_E0F7EC04A3">URLs </span><span class="de_23C19DE48C">попросту не используются.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">&#160;2) &#160; &#160; </span><span class="de_23C19DE48C">Socket с архивацией. Данный метод несколько сложнее предыдущего но позволяет отсылать&#160; <strong>Launcher’у </strong>обновления в виде архивов. Это существенно сэкономит трафик и ускорит процесс обновления. Хотя везде есть и свои недостатки. Процесс архивации использует процессор, так что не стоит этим злоупотреблять. Прежде всего стоит установить поле </span><span class="de_E0F7EC04A3">Need % to download full package</span><span class="de_23C19DE48C">. Данное поле устанавливает сколько не хватает % от полного клиента. При построении списка обновлений автоматически создается архив с полным клиентом. Если в данном поле установить 80% то это значит что если пользователю необходимо скачать более 80% игры то автоматически начнется скачивание полного клиента. После установки данного поля следует перейти на вкладку </span><span class="de_E0F7EC04A3">Configs</span><span class="de_23C19DE48C"> и установить поле </span><span class="de_E0F7EC04A3">Min files to use archive</span><span class="de_23C19DE48C">. Это поле обозначает какое минимальное количество файлов должен запросить <strong>Launcher </strong>чтобы для него создался архив. Как это выглядит на практике? Предположим что в этом поле находится число 10. Если клиент запрашивает всего 9ть файлов (или еще меньше) то файлы будут переданы без архивации. Если 10 и более файлов — будет создан архив. Далее нужно установить поле </span><span class="de_E0F7EC04A3">Min update size to use archive</span><span class="de_23C19DE48C">. Установленное число измеряется в байтах. 1 мегабайт это 1 048 576 байт. При запросе пользователя, нужных файлов для обновления, их размер будет суммироваться. Если общий размер будет меньше, числа которое установлено в данном поле, то архив создан не будет. Последние 2 поля взаимодействуют между собой. Предположим что архив надо создавать если клиент запрашивает хотя бы 10 файлов и их общий размер больше 1 мегабайта. Тогда в поле </span><span class="de_E0F7EC04A3">Min files to use archive</span><span class="de_23C19DE48C"> нужно вписать 10, а в поле </span><span class="de_E0F7EC04A3">Min update size to use archive</span><span class="de_23C19DE48C"> вписать 1 048 576. После применения настроек обязательно нажмите на кнопку </span><span class="de_E0F7EC04A3">Save</span><span class="de_23C19DE48C">. Система архивирования полностью готова к использованию. </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">&#160;3) &#160; &#160; </span><span class="de_23C19DE48C">HTTP. Сначала надо создать веб-сервер с помощью Apache , XAMPP или др. и скопировать на веб-сервер последнюю версию клиента игры. После того как веб-сервер будет создан следует в&#160; <strong>UpdSrv’е </strong>в поле </span><span class="de_E0F7EC04A3">Host </span><span class="de_23C19DE48C">указать путь к игровой директории на веб-сервере. Предположительно путь должен быть таким: </span><span class="de_E0F7EC04A3">http://myip/MyGame/ </span><span class="de_23C19DE48C">. Затем нажать на кнопку </span><span class="de_E0F7EC04A3">Refresh </span><span class="de_23C19DE48C">и подождать пока будет создан список файлов. Ссылки на файлы будут сгенерированы автоматически. Например если у Вас в игровом клиенте есть файл </span><span class="de_E0F7EC04A3">game.exe </span><span class="de_23C19DE48C">который расположен в корне игры, и вы вписали в поле </span><span class="de_E0F7EC04A3">Host http://myip/MyGame/</span><span class="de_23C19DE48C">, то ссылка на файл будет: </span><span class="de_E0F7EC04A3">http://myip/MyGame/game.exe</span><span class="de_23C19DE48C">. </span><span class="de_4602434F27">Обязательно проверьте можно ли скачать файл через браузер! Если файл нельзя скачать через браузер , его не скачает и <strong>Launcher</strong>!</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_7ECBECEBE5">&#160;4) &#160; &#160; </span><span class="de_23C19DE48C">FTP. Прежде всего Вам понадобится </span><a href="http://ru.wikipedia.org/wiki/&#x0421;&#x0440;&#x0430;&#x0432;&#x043D;&#x0435;&#x043D;&#x0438;&#x0435;_FTP-&#x0441;&#x0435;&#x0440;&#x0432;&#x0435;&#x0440;&#x043E;&#x0432;"><span class="de_F88D357FA0">FTP сервер</span></a><span class="de_7ECBECEBE5">. Поместите последнюю версию игрового клиента на FTP Server. Теперь в </span><span class="de_23C19DE48C"><strong>UpdSrv’е </strong>надо перейти на вкладку </span><span class="de_E0F7EC04A3">Configs. </span><span class="de_23C19DE48C">В поле </span><span class="de_E0F7EC04A3">FTP Host</span><span class="de_23C19DE48C"> надо вписать IP-адрес или DNS Вашего&#160; FTP Server'a. Поля </span><span class="de_E0F7EC04A3">FTP Login</span><span class="de_23C19DE48C"> и </span><span class="de_E0F7EC04A3">FTP Password</span><span class="de_23C19DE48C"> заполнить Вашими авторизационными данными. Если Вы использовали дополнительные каталоги (файлы размещены не в корневой директории) то в&#160; <strong>UpdSrv’е </strong>во вкладке </span><span class="de_E0F7EC04A3">Configs</span><span class="de_23C19DE48C"> в поле </span><span class="de_E0F7EC04A3">FTP Folder </span><span class="de_23C19DE48C">введите название каталога. Теперь остается только нажать на кнопку Refresh.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C">&#160;&#160; &#160; После всего проделанного Вам осталось установить нужные параметры во вкладке </span><span class="de_E0F7EC04A3">Configs </span><span class="de_23C19DE48C">(<strong>UpdSrv</strong>) и нажать на заветную кнопку </span><span class="de_E0F7EC04A3">Start UpdSrv</span><span class="de_23C19DE48C">. Всё, система полностью готова к работе! </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_E0F7EC04A3">Создание динамического обновления и проверки критических файлов.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C">&#160;&#160; &#160; Каждое ПО имеет ряд критических файлов которые очень важны для корректной работы программы. Система динамического обновления и проверки критических файлов создана с целью защитить эти файлы. Данная система будет постоянно проверять заданные файлы на целостность. Для того чтобы использовать данную систему необходимо перейти на вкладку </span><span class="de_E0F7EC04A3">Configs</span><span class="de_23C19DE48C"> и установить поле </span><span class="de_E0F7EC04A3">Must update client for start game</span><span class="de_23C19DE48C"> в Yes. После этого в поле </span><span class="de_E0F7EC04A3">What update use when gaming starts</span><span class="de_23C19DE48C"> выбрать Mini Update. Теперь система активирована. Далее Вам следует перейти на вкладку </span><span class="de_E0F7EC04A3">Mini Update</span><span class="de_23C19DE48C">. Она очень похожа на </span><span class="de_E0F7EC04A3">General Update</span><span class="de_23C19DE48C"> но с тем отличием что здесь нету пакетов. Все остальное работает по тому же принципу. Вы просто добавляете файлы в список и все. Теперь при загрузке игры&#160; <strong>Launcher </strong>проверит все критические файлы и только потом разрешит запуск игры. Во время работы игры&#160; <strong>Launcher </strong>будет динамически сканировать данные файлы на наличие изменений.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_E0F7EC04A3">Загрузка дополнительных библиотек.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C">&#160;&#160; &#160; Очень часто Администратор проекта сталкивался с проблемой подгрузки дополнительных DLL файлов в клиент. Большой проблемой это становилось когда места на «хук» уже не было. Специально для этого был разработан <strong>Loader. </strong>Он позволяет загрузить любое количество библиотек и вести полный контроль над этими библиотеками. Все что Вам нужно так это сделать&#160; только 1 «хук» нашей библиотеки. </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_E0F7EC04A3"><strong>Информация для хука.</strong> Внедрите библиотеку Loader.dll в Ваш клиент и вызовите функцию Load. </span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;"><span class="de_23C19DE48C">&#160;&#160; &#160; Для того чтобы указать какие библиотеки надо загружать перейдите на вкладку </span><span class="de_E0F7EC04A3">Loader</span><span class="de_23C19DE48C">. Вы увидите 2 колонки. Колонка слева представляет список DLL файлов. Колонка справа отвечает за загружаемые функции. Для того чтобы добавить новую DLL просто нажмите на кнопку </span><span class="de_E0F7EC04A3">Add</span><span class="de_23C19DE48C">. У Вас появится диалоговое окно где Вы можете указать имя Вашей библиотеки. Если у Вам надо загрузить экспортируемую функцию — впишите ее имя в поле </span><span class="de_E0F7EC04A3">Additional Function</span><span class="de_23C19DE48C">. Когда список нужных библиотек составлен Вам следует его сохранить. Нажмите на кнопку </span><span class="de_E0F7EC04A3">Save</span><span class="de_23C19DE48C"> и сохраните файл под именем <strong>loader.dat</strong>, этот файл должен быть размещен возле&#160; <strong>Launcher’а</strong>.</span></div>
<div class="p" style="text-align: left; direction: ltr; margin-left: 0px; text-indent: 0px;">&#160;</div>
</div>				</td>
			</tr>
		</table>
	</body>
</html>